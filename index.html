<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
    
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="style.css">

    
    
    
<title>3107 Labelmaker</title>
    
    
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.14.3/xlsx.full.min.js"></script>
<script src="xlsx-to-table.js"></script>
    
    <script>
        //매개변수에 입력한 해당 셀 주소의 값을 데이터 테이블에서 가져오는 함수
        //예시: load(1,1)일 경우 A1(아이디 sjs-A1)을 호출함~
        var ABCD = ['A','B','C','D'];    
        function load(cell,i) {
            console.log(document.getElementById('sjs-'+ABCD[i - 1]+ cell).innerHTML);
        }

        //table 태그에 table 아이디를 만드는 함수
        function makeTableID(){
            document.getElementsByTagName('table')[0].id="table"
            console.log("table 태그에 table 아이디 생성 완료")
        }


        //몇 줄인지 체크하는 함수 (개발용)
        function checkrows() {
            rowNum = document.getElementById('table').rows.length;
            console.log("생성 완료! "+rowNum+"줄입니다.");
        }
        
        function checkerror() {
            if (document.getElementsByTagName('table')[0] == undefined) {
                alert("올바른 시트 파일을 첨부해주세요.");
            }
        }
    </script>
    
    
    <script>
        //인쇄 창 여는 함수
        var openWin;
        function openChild() {
            // window.name = "부모창 이름"; 
            window.name = "main";
            // window.open("open할 window", "자식창 이름", "팝업창 옵션");
            openWin = window.open("./print/index.html",
                    "print", "width=800, height=480, resizable = no, scrollbars = no");
        }
        
        //인쇄
        function printLabel() {
            
            if (document.getElementsByTagName('table')[0] == undefined) {
                alert("올바른 시트 파일을 첨부해주세요.");
            } else {
                // 체크값을 변수로
                chk1 = document.getElementById("firstrow").checked;
                chk2 = document.getElementById("savelabel").checked;
                chk3 = document.getElementById("sender").checked;
                dear = document.getElementById("dear").checked;

                // 라벨 절약 모드
                if (document.getElementById("savelabel").checked == true) {
                    emptyLabel = document.getElementById("emptyLabel").value;
                }                
                // 보내는 사람 출력
                if (document.getElementById("sender").checked == true) {
                    senderName = document.getElementById("tName").value;
                    senderAddress = document.getElementById("tAddress").value;
                    senderPhone = document.getElementById("tPhone").value;
                }

                if (checkerror() != 1) {
                    makeTableID();
                    openChild();     
                }
            }
        }


   </script>

    
    
    
</head>
<body>
<div id="wrap">
    <div id="header">
        <p class="title">
            Labelmaker for 3107
        </p>
    </div>
    <div id="main">
        
        <div id="main-text">
            <p>주소록이 작성된 시트를 첨부하십시오. 데이터는 서버에 저장되지 않습니다. <a href="./test3.xlsx">예제 파일</a></p>
            <p>(시트에서 열을 이름 / 주소 / 전화번호로 맞춰서 작성해야 합니다)</p>
        </div>
        <div id="form">
            <div id="buttons">
                <div id="fileselect">
               <input type="file" id="excelFile" accept=".xlsx, .xls, .cell" onchange="excelExport(event)"> 
            </div>
            <div id="printbutton">
                <label>인쇄 영역: </label>
                <input type="number" class="textbox" id="printMin" value="1">
                <label>~</label>
                <input type="number" class="textbox" id="printMax" value="1">
                <input type="button" class="button" name="test" value="인쇄" onclick="printLabel()">
            </div>
            </div>


            <div id="checkers">
                <div id="check1" class="checkbox-row">
                    <div>
                        <label><input type="checkbox" class="checkbox" id="firstrow">데이터의 첫 열을 출력하기</label>
                    </div>
                </div>
                <div id="check2" class="checkbox-row">
                    <div>
                        <label><input type="checkbox" class="checkbox" id="dear">이름 옆에 귀하 붙이기</label>
                    </div>
                </div>
                <div id="check3" class="checkbox-row">
                    <div>
                        <label><input type="checkbox" class="checkbox" id="savelabel">공백 라벨 출력 </label><input type="number" class="textbox" id="emptyLabel" value="0" min="0" max="15">
                    </div>
                </div>
                <div id="check4" class="checkbox-row">
                    <div>
                        <label><input type="checkbox" class="checkbox" id="sender">매 줄마다 보내는 사람 주소 출력</label>
                    </div>
                </div>
                <div id="check5" class="checkbox-row">
                    <div>

                        <input type="text" class="textbox tName" id="tName" placeholder="이름">
                        <input type="text" class="textbox tAddress" id="tAddress" placeholder="주소">
                        <input type="text" class="textbox tPhone" id="tPhone" placeholder="전화번호">

                    </div>
                </div>
            </div>
        </div>



        <hr>
        <div id="displayExcelHtml"></div>



    </div>
    <div id="footer">
        <p>이 웹사이트는 안타깝게도 크롬에 최적화되어 있습니다.</p>
    </div>
</div>
    

    
    
       
       
    
</body>
</html>